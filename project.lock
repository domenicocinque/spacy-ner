download:
  cmd: python -m weasel run download
  script:
    - python -m spacy download en_core_web_md
  deps: []
  outs: []
convert:
  cmd: python -m weasel run convert
  script:
    - python -m spacy convert assets/train.txt corpus/ --converter conll -n 3
    - python -m spacy convert assets/dev.txt corpus/ --converter conll -n 3
    - python -m spacy convert assets/test.txt corpus/ --converter conll -n 3
  deps:
    - path: assets/train.txt
      md5: a595d83962c932f2b59fb52227a16086
    - path: assets/dev.txt
      md5: d9492db1858f07a26cbb1f3b3f98a49f
    - path: assets/test.txt
      md5: 9cdd4db35b65db782ea91c80f62d074e
  outs:
    - path: corpus/train.spacy
      md5: 9580f06ef093295c9faed4c4ad197502
    - path: corpus/dev.spacy
      md5: dd34c80d16e78da82d2a7ed3f92c8270
    - path: corpus/test.spacy
      md5: bb206282199c0524c1ad7b5e7025fa5c
create-config:
  cmd: python -m weasel run create-config
  script:
    - python -m spacy init config --lang en --pipeline ner configs/config.cfg --force
  deps: []
  outs:
    - path: configs/config.cfg
      md5: edc129c73686d45c362a1fe4fc6cbc36
train:
  cmd: python -m weasel run train
  script:
    - python -m spacy train configs/config.cfg --output training/ --paths.train corpus/train.spacy
      --paths.dev corpus/dev.spacy --training.eval_frequency 10 --training.patience
      50 --gpu-id 0 --initialize.vectors en_core_web_md --components.tok2vec.model.embed.include_static_vectors
      true
  deps:
    - path: configs/config.cfg
      md5: edc129c73686d45c362a1fe4fc6cbc36
    - path: corpus/train.spacy
      md5: 9580f06ef093295c9faed4c4ad197502
    - path: corpus/dev.spacy
      md5: dd34c80d16e78da82d2a7ed3f92c8270
  outs:
    - path: training/model-best
      md5: 55cefa79670e81190a069c49e337683c
evaluate:
  cmd: python -m weasel run evaluate
  script:
    - python -m spacy evaluate training/model-best corpus/dev.spacy --output training/metrics.json
  deps:
    - path: corpus/dev.spacy
      md5: dd34c80d16e78da82d2a7ed3f92c8270
    - path: training/model-best
      md5: 55cefa79670e81190a069c49e337683c
  outs:
    - path: training/metrics.json
      md5: 504ca89d30d2a6cf7c6fd25998fde04c
package:
  cmd: python -m weasel run package
  script:
    - python -m spacy package training/model-best packages --name ner_demo --version
      0.0.0 --force
  deps:
    - path: training/model-best
      md5: 4bc92596d6ba00757fd8432a04b336d2
  outs:
    - path: packages/en_ner_demo-0.0.0/dist/en_ner_demo-0.0.0.tar.gz
      md5: cb6051845307d579f57bef88dbea48d8
download-data:
  cmd: python -m weasel run download-data
  script:
    - dvc pull
  deps: []
  outs: []
download-model:
  cmd: python -m weasel run download-model
  script:
    - python -m spacy download en_core_web_md
  deps: []
  outs: []
